<NAME>
rotate_templates_and_seed_expansion
</NAME>

<DESCRIPTION>
I propose a targeted improvement to the recursive wave construction to increase FirstFit pressure while keeping the clique number low.

Key ideas:
- Seed T with a small set of disjoint unit intervals (4 units) to create richer early interactions.
- Replace the fixed single-start pattern by a deterministic cycle of 4 start-patterns. Rotating starts breaks regular reuse that FirstFit can exploit.
- Introduce a small template bank (4 connector gadgets) and pick one per round, rotating deterministically to diversify coupling patterns across iterations without increasing per-round cost significantly.
- Add lightweight bridges and small caps (short intervals placed between translated blocks) to couple colors across blocks while avoiding creation of large cliques.
- Increase default rounds to 4 (configurable) to give more expansion depth and more color pressure.
- Keep all changes local to the EVOLVE block so the rest of the program is unchanged.

These changes are designed to preserve the multiplicative growth structure (so number of intervals remains manageable) while making color reuse by FirstFit harder, with a modest increase in rounds and diversified patterns.

The SEARCH block below matches the current EVOLVE block exactly and is replaced by a more diversified construction.
</DESCRIPTION>

<DIFF>
<<<<<<< SEARCH
# EVOLVE-BLOCK-START

def construct_intervals(rounds=3):
  """
  Construct a sequence of intervals of real line,
  in the order in which they are presented to FirstFit,
  so that it tends to maximize the number of colors used by FirstFit
  divided by the maximum number of intervals that cover a single point
  through a recursive wave construction.

  The construction generalizes the two-round pattern used in Figure 4 of
  https://arxiv.org/abs/1506.00192 to a multi-round recursive expansion.

  Returns:
    intervals: list of tuples, each tuple (l, r) represents an open interval from l to r
  """
  T = [(0, 1)]
  for round_idx in range(rounds):
    lo = min(l for l, r in T)
    hi = max(r for l, r in T)
    delta = hi - lo
    S = []
    # In earlier rounds we apply a compact set of shifts; in later rounds,
    # we widen the set of shifts to inject more waves and increase color usage.
    starts = [2, 6, 10, 14]
    if round_idx >= 1:
      starts += [18, 22, 26, 30]
    for start in starts:
      S += [(delta * start + l - lo, delta * start + r - lo) for l, r in T]
    # additional local blocks to create overlapping waves without increasing omega too much
    S += [
      (delta * 1, delta * 5),
      (delta * 12, delta * 16),
      (delta * 4, delta * 9),
      (delta * 8, delta * 13)
    ]
    T = S
  return T

  # return [  # Figure 3, OPT=2, FF=4
  #   (2,3),
  #   (6,7),
  #   (10,11),
  #   (14,15),
  #   (1,5),
  #   (12,16),
  #   (4,9),
  #   (8,13),
  # ]

# EVOLVE-BLOCK-END
=======
# EVOLVE-BLOCK-START

def construct_intervals(rounds=4):
  """
  Construct a sequence of intervals in presentation order with diversified
  start-patterns, connector templates, light bridges and caps to increase
  FirstFit color pressure while keeping the clique number small.

  Changes vs. the previous simple replicator:
  - Seed with four disjoint unit intervals to create richer early interactions.
  - Cycle among several deterministic start-patterns to disrupt regular reuse.
  - Cycle a small bank of 4-interval connector templates (one per round).
  - Add light bridges and short caps between translated blocks to couple colors.
  - Default rounds increased to 4; rounds is configurable.
  """
  # Seed: several disjoint unit intervals to keep omega low but enable coupling
  T = [
    (0.0, 1.0),
    (2.0, 3.0),
    (4.0, 5.0),
    (6.0, 7.0)
  ]

  # Cycle of start-patterns (rotating choices to avoid predictable reuse)
  start_patterns = [
      (2, 6, 10, 14),
      (1, 5, 9, 13),
      (3, 7, 11, 15),
      (2, 4, 8, 12),
  ]

  # Small bank of 4-interval connector templates (keeps per-round additive cost small)
  template_bank = [
      ((1, 5), (12, 16), (4, 9), (8, 13)),
      ((0.5, 4.5), (11, 15), (3.5, 8.5), (7, 12)),
      ((1, 4), (6, 9), (3, 7), (9, 13)),
      ((2, 6), (7, 11), (0, 3), (10, 14)),
  ]

  for round_idx in range(rounds):
    lo = min(l for l, r in T)
    hi = max(r for l, r in T)
    span = hi - lo if hi > lo else 1.0

    # pick start pattern and template deterministically
    starts = list(start_patterns[round_idx % len(start_patterns)])
    template = template_bank[round_idx % len(template_bank)]

    S = []

    # vary block insertion order each round to perturb arrival ordering
    if round_idx % 3 == 0:
      block_order = starts
    elif round_idx % 3 == 1:
      block_order = list(reversed(starts))
    else:
      block_order = starts[1:] + starts[:1]

    # Build translated copies with alternating inner order for T
    for i, st in enumerate(block_order):
      base = T if ((round_idx + i) % 2 == 0) else list(reversed(T))
      base_off = span * st - lo
      # append clones (preserving presentation order)
      for (l, r) in base:
        S.append((l + base_off, r + base_off))

      # light bridge: a short interval that overlaps the tail of this block and head of the next
      if i + 1 < len(block_order):
        nxt = block_order[i + 1]
        bstart = span * (st + 0.5) - lo
        bend = span * (nxt + 0.5) - lo
        # make it short compared to span to avoid increasing omega much
        S.append((min(bstart, bend) + 0.1 * span * 1e-6, max(bstart, bend) - 0.1 * span * 1e-6))

    # add the 4-interval connector gadget (scaled by span)
    for (a, b) in template:
      S.append((span * a, span * b))

    # add a few short caps sparsely between blocks to press colors without raising omega
    max_st = max(starts)
    step = max(2, int(max_st // 3))
    for j in range(2, max_st, step):
      a = span * (j - 0.4)
      b = span * (j + 0.6)
      # make these caps short relative to span
      S.append((a + 0.01 * span, b - 0.01 * span))

    # update T for next round
    T = S

  return T

# EVOLVE-BLOCK-END
>>>>>>> REPLACE
</DIFF>